<!--
  ~ ------------
  ~ StoryPlaces
  ~ ------------
  ~ This application was developed as part of the Leverhulme Trust funded
  ~ StoryPlaces Project. For more information, please visit storyplaces.soton.ac.uk
  ~ Copyright (c) 2017 University of Southampton
  ~
  ~ David Millard, dem.soton.ac.uk
  ~ Andy Day, a.r.day.soton.ac.uk
  ~ Kevin Puplett, k.e.puplett.soton.ac.uk
  ~ Charlie Hargood, chargood.bournemouth.ac.uk
  ~ David Pepper, d.pepper.soton.ac.uk
  ~
  ~ All rights reserved.
  ~
  ~ Redistribution and use in source and binary forms, with or without
  ~ modification, are permitted provided that the following conditions are met:
  ~ - Redistributions of source code must retain the above copyright
  ~   notice, this list of conditions and the following disclaimer.
  ~ - Redistributions in binary form must reproduce the above copyright
  ~   notice, this list of conditions and the following disclaimer in the
  ~   documentation and/or other materials provided with the distribution.
  ~ - The name of the University of Southampton nor the name of its
  ~   contributors may be used to endorse or promote products derived from
  ~   this software without specific prior written permission.
  ~
  ~ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  ~ AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  ~ IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ~ ARE DISCLAIMED. IN NO EVENT SHALL THE ABOVE COPYRIGHT HOLDERS BE LIABLE FOR ANY
  ~ DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  ~ (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  ~ LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ~ ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  ~ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  ~ THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  -->

<template>

    <require from="components/icons/information-icon.html"></require>
    <require from="resources/value-converters/FloatToString"></require>
    <require from="resources/value-converters/IntToString"></require>
    <require from="components/attributes/scroll-on-edit"></require>
    <require from="components/elements/mutable-list/mutable-list"></require>
    <require from="components/elements/toggle-switch/toggle-switch"></require>
    <require from="components/elements/image-picker/image-picker"></require>

    <div class="padding">
        <div class="panel panel-default">
            <div class="panel-heading">
                Page Details
            </div>
            <div class="panel-body">
                <div class="form-group">
                    <label for="name">Page Name:
                        <information-icon help-text="The title of the page"></information-icon>
                    </label>
                    <input type="text" class="form-control" id="name" value.bind="page.name & validate:rules"
                           scroll-on-edit change.delegate="setDirty()">
                </div>

                <div class="form-group">
                    <label for="content">Page Content:
                        <information-icon help-text="The content of the page"></information-icon>
                    </label>
                    <textarea class="form-control" id="content" rows="5" value.bind="page.content & validate:rules"
                              scroll-on-edit change.delegate="setDirty()"></textarea>
                </div>
                <div class="form-group">
                    <label for="hint-text">Hint Text:
                        <information-icon
                                help-text="A brief hint shown to the reader before they select a page"></information-icon>
                    </label>
                    <input type="text" class="form-control" id="hint-text" value.bind="page.pageHint & validate:rules"
                           scroll-on-edit change.delegate="setDirty()">
                </div>

            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                Media
            </div>
            <div class="panel-body">
                <image-picker image-ids.bind="story.imageIds" selected-id.bind="page.imageId" story-id.bind="story.id"></image-picker>



            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                Narrative Constraints
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <label>Allow Multiple Readings:</label>
                            <information-icon
                                    help-text="Is the reader allowed to read this page more than once?"></information-icon>
                            <toggle-switch checked.bind="page.allowMultipleReadings" off="No" on="Yes"
                                           colourise="yes-no"
                                           change.delegate="setDirty()"></toggle-switch>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <label>Finishes story:</label>
                            <information-icon
                                    help-text="Reading this page will end the story"></information-icon>
                            <toggle-switch checked.bind="page.finishesStory" off="No" on="Yes"
                                           colourise="yes-no"
                                           change.delegate="setDirty()"></toggle-switch>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <label>Unlocked By:</label>
                            <information-icon
                                    help-text="Pages that must be read before this page becomes available"></information-icon>
                            <toggle-switch checked.bind="unlockedOperator" off="Any Of" on="All Of:"
                                           change.delegate="setDirty()"></toggle-switch>
                            <mutable-list available-items.bind="availablePages"
                                          selected-items.bind="page.unlockedByPageIds"
                                          placeholder="Start typing a page name"
                                          change.delegate="setDirty()"></mutable-list>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <label class="moc-fudge">Member Of Chapters:
                                <information-icon
                                        help-text="Chapters which this page is a member of. Pages in a chapter can only be read when that chapter is active"></information-icon>
                            </label>
                            <mutable-list id="member-of" available-items.bind="availableChapters"
                                          selected-items.bind="memberOfChapters"
                                          placeholder="Start typing a chapter name"></mutable-list>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                Location Constraint
                <button class="btn btn-xs btn-danger pull-right" click.delegate="removeLocation()"
                        if.bind="location"><span class="glyphicon glyphicon-trash"></span> Delete
                </button>
            </div>
            <div class="panel-body" if.bind="location === undefined">
                <button class="btn btn-success" click.delegate="addLocation()"><span
                        class="glyphicon glyphicon-plus"></span> Add Location
                </button>
            </div>
            <div class="panel-body" if.bind="location !== undefined">
                <div class="row">
                    <div class="col-xs-12 col-sm-4">
                        <div class="form-group">
                            <label for="lat">Latitude:
                                <information-icon
                                        help-text="The latitude of the location of the page"></information-icon>
                            </label>
                            <input type="text" class="form-control" id="lat"
                                   value.bind="location.lat | floatToString & validate:rules" scroll-on-edit
                                   change.delegate="setDirty()">
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <div class="form-group">
                            <label for="lat">Longitude:
                                <information-icon
                                        help-text="The longitude of the location of the page"></information-icon>
                            </label>
                            <input type="text" class="form-control" id="long"
                                   value.bind="location.long | floatToString & validate:rules" scroll-on-edit
                                   change.delegate="setDirty()">
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-4">
                        <div class="form-group">
                            <label for="radius">Radius(m):
                                <information-icon
                                        help-text="The radius within which the page is valid."></information-icon>
                            </label>
                            <input type="text" class="form-control" id="radius"
                                   value.bind="location.radius | intToString & validate:rules" scroll-on-edit
                                   change.delegate="setDirty()">
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <button class="btn btn-block" class.bind="droppingPin ? 'btn-danger' : 'btn-primary'"
                                    click.delegate="dropPinOnMap()"><span
                                    class="glyphicon glyphicon-map-marker"></span> ${droppingPin ? 'Cancel dropping pin'
                                : 'Drop pin on map'}
                            </button>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6">
                        <div class="form-group">
                            <button class="btn btn-primary btn-block" click.delegate="useCurrentLocation()"><span
                                    class="glyphicon glyphicon-record"></span> Use current location
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>